config:
  licence_text: ""
  import_prefix: "pinaht.knowledge.types"
  visualization_filename: "typegraph.gv"
  root_type: "Network"
visualization:
  branch_color: "#75abfc"
  inter_color: "#dddddd"
  leaf_extends_color: "#e1a0d5"
  leaf_enum_color: "#a3df93"
  leaf_custom_color: "#ffa6a6"
  abstract_color: "#dddddd"
  node_label_fontname: "LiberationSans"
  node_label_fontsize: "15"
  node_label_fontcolor: "black"
  node_content_fontname: "Liberation Mono"
  edge_label_fontname: "LiberationSans"
  edge_label_fontsize: "11"
  edge_label_fontcolor: "dimgray"
  leaf_shape: "box"
  branch_shape: "ellipse"
  inter_shape: "house"
  abstract_shape: "octagon"
  edge_normal_shape: "solid"
  edge_abstract_shape: "dotted"
  node_content_max_line_length: 72
types:
  - name: "Network"
    kind: "BRANCH"
    description: "Describes an Object of the Type Network. A network contains several targets to attack."
    childs:
      - name: "targets"
        classname: "Target"
        type: "LIST"
      - name: "local_host"
        classname: "LocalHost"
        type: "SINGLETON"
      - name: "net_mask"
        classname: "NetMask"
        type: "SINGLETON"
      - name: "address"
        classname: "IPAddress"
        type: "SINGLETON"
  - name: "NetMask"
    kind: "LEAF_EXTENDS"
    description: "The number of 1 in the net mask for the network."
    is: "int"
  - name: "LocalHost"
    kind: "BRANCH"
    description: "Describes an Object of the Type LocalHost.\nA LocalHost describes knowledge about the computer the program is running on."
    childs:
      - name: "address"
        classname: "IPAddress"
        type: "LIST"
      - name: "executable"
        classname: "Executable"
        type: "LIST"
  - name: "Target"
    kind: "BRANCH"
    description: "Describes an Object of the Type Target. A target is one specific computer Pinaht tries to hack."
    childs:
      - name: "services"
        classname: "Service"
        type: "LIST"
      - name: "os"
        classname: "OS"
        type: "SINGLETON"
      - name: "address"
        classname: "IPAddress"
        type: "SINGLETON"
      - name: "shells"
        classname: "Shell"
        type: "LIST"
      - name: "status"
        classname: "Status"
        type: "SINGLETON"
      - name: "hostname"
        classname: "Name"
        type: "LIST"
      - name: "login_user"
        classname: "LoginUser"
        type: "LIST"
      - name: "credentials"
        classname: "Credentials"
        type: "SINGLETON"
      - name: "filesystem"
        classname: "FsTree"
        type: "SINGLETON"
  - name: "Service"
    kind: "BRANCH"
    description: "Describes an Object of the Type Service. A service is a program, that is accessible from the outside."
    childs:
      - name: "port"
        classname: "Port"
        type: "SINGLETON"
      - name: "service_name"
        classname: "Name"
        type: "SINGLETON"
      - name: "service_version"
        classname: "Version"
        type: "SINGLETON"
      - name: "protocol"
        classname: "Protocol"
        type: "SINGLETON"
      - name: "transport"
        classname: "Transport"
        type: "SINGLETON"
      - name: "status"
        classname: "Status"
        type: "SINGLETON"
      - name: "extrainfo"
        classname: "ExtraInfo"
        type: "LIST"
    fuzzy_eq: |-
      if self.port == other.port:
          return 1.0
      return 0.0
  - name: "Transport"
    kind: "LEAF_ENUM"
    description: "a ENUM over the Transport Protocol (OSI Layer 4)"
    enum:
      - "TCP"
      - "UDP"
      - "SCTP"
      - "TLS"
      - "DTLS"
  - name: "Port"
    kind: "LEAF_EXTENDS"
    description: "Describes an Object of the Type Port."
    is: "int"
  - name: "OS"
    kind: "BRANCH"
    description: "Describes an Object of the Type OS."
    childs:
      - name: "os_type"
        classname: "OperatingSystemType"
        type: "SINGLETON"
      - name: "expected_version"
        classname: "Version"
        type: "SINGLETON"
  - name: "IPAddress"
    kind: "LEAF_EXTENDS"
    description: "Describes an Object of the Type IPAddress. An IP address is a single network Address."
    is: "int"
  - name: "Shell"
    kind: "ABSTRACT"
    description: "Describes an Object of the Type Shell."
    childs:
      - name: "privilege"
        classname: "Privilege"
        type: "SINGLETON"
      - name: "shelluser"
        classname: "User"
        type: "SINGLETON"
  - name: "Privilege"
    kind: "LEAF_ENUM"
    description: "Describes an Object of the Type Privilege."
    enum:
      - "ROOT"
      - "WEBSERVER"
      - "OTHER"
  - name: "User"
    kind: "LEAF_EXTENDS"
    description: "Describes an Object of the Type User."
    is: "str"
  - name: "Name"
    kind: "LEAF_EXTENDS"
    description: "Describes an Object of the Type Name."
    is: "str"
  - name: "Password"
    kind: "LEAF_EXTENDS"
    description: "Describes an Object of the Type Password."
    is: "str"
  - name: "Version"
    kind: "LEAF_CUSTOM"
    description: "Describes an Object of the Type Version."
  - name: "OperatingSystemType"
    kind: "LEAF_ENUM"
    description: "Describes an Object of the Type OperatingSystemType."
    enum:
      - "LINUX"
      - "WINDOWS"
      - "OS_2"
      - "BSD"
  - name: "Protocol"
    kind: "BRANCH"
    description: "Describes an Object of the Type Protocol."
    childs:
      - name: "name"
        classname: "Name"
        type: "SINGLETON"
      - name: "extended_name"
        classname: "Name"
        type: "SINGLETON"
      - name: "version"
        classname: "Version"
        type: "SINGLETON"
  - name: "Status"
    kind: "LEAF_ENUM"
    description: "A ENUM that represents the status."
    enum:
      - "UP"
      - "DOWN"
      - "OPEN"
      - "CLOSED"
      - "UNKNOWN"
  - name: "ExtraInfo"
    kind: "ABSTRACT"
    description: "Extra Information."
  - name: "Script"
    kind: "BRANCH"
    description: "The result of a nmap script."
    childs:
      - name: "id"
        classname: "Name"
        type: "SINGLETON"
      - name: "output"
        classname: "Text"
        type: "SINGLETON"
      - name: "elements"
        classname: "ScriptElement"
        type: "LIST"
    extends: "ExtraInfo"
  - name: "Info"
    kind: "LEAF_EXTENDS"
    description: "Additional infos about the service."
    is: "str"
    extends: "ExtraInfo"
  - name: "HeartbleedVulnerable"
    kind: "LEAF_EXTENDS"
    description: "Indicates if the service is vulnerable for the heartbleed attack."
    is: "bool"
    extends: "ExtraInfo"
  - name: "Text"
    kind: "LEAF_EXTENDS"
    description: "Just plain old text."
    is: "str"
  - name: "ScriptElement"
    kind: "BRANCH"
    description: "A Element of a script result"
    childs:
      - name: "id"
        classname: "Name"
        type: "SINGLETON"
      - name: "output"
        classname: "Text"
        type: "SINGLETON"
  - name: "LoginUser"
    kind: "BRANCH"
    description: "Describes an Object of the Type User."
    childs:
      - name: "name"
        classname: "Name"
        type: "SINGLETON"
      - name: "password"
        classname: "Password"
        type: "SINGLETON"
  - name: "FsTree"
    kind: "ABSTRACT"
    description: "Tree structure mirroring the target's filesystem"
    extraimports:
      - "import string"
  - name: "LocalFsTree"
    kind: "LEAF_CUSTOM"
    description: "Tree structure mirroring a local filesystem"
    extends: "FsTree"
  - name: "WebserverFsTree"
    kind: "LEAF_CUSTOM"
    description: "Tree structure mirroring a webserver's filesystem"
    extends: "FsTree"
    extraimports:
      - "import requests"
  - name: "Executable"
    kind: "LEAF_EXTENDS"
    description: "Describes an Executable available on the host."
    is: "str"
  - name: "ProcessShell"
    kind: "BRANCH"
    description: "Wraps shells in external processes."
    extends: "Shell"
    extraimports:
      - "from pinaht.knowledge.types.shell import ShellTimeoutError"
      - "import pexpect"
      - "import random"
      - "import string"
  - name: "SecureShell"
    kind: "BRANCH"
    description: "Uses paramiko package to create a shell and execute commands over SSH."
    extends: "Shell"
    extraimports:
      - "from pinaht.knowledge.types.shell import ShellTimeoutError"
      - "import paramiko"
      - "import random"
      - "import string"
      - "import socket"
      - "import re"
  - name: "MetasploitShell"
    kind: "BRANCH"
    description: "Wraps shells created by Metasploit."
    extends: "Shell"
  - name: "SocketShell"
    kind: "BRANCH"
    description: "Wraps Python socket shells."
    extends: "Shell"
  - name: "Credentials"
    kind: "BRANCH"
    description: "Holds unmatched usernames and passwords."
    childs:
      - name: "passwords"
        classname: "Password"
        type: "LIST"
      - name: "users"
        classname: "Name"
        type: "LIST"